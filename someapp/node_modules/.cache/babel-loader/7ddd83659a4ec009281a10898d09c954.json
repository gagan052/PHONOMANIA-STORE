{"ast":null,"code":"import { resize } from '../resize/index.mjs';\nimport { createScrollInfo } from './info.mjs';\nimport { createOnScrollHandler } from './on-scroll-handler.mjs';\nconst scrollListeners = new WeakMap();\nconst resizeListeners = new WeakMap();\nconst onScrollHandlers = new WeakMap();\n\nconst getEventTarget = element => element === document.documentElement ? window : element;\n\nfunction scroll(onScroll) {\n  let {\n    container = document.documentElement,\n    ...options\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let containerHandlers = onScrollHandlers.get(container);\n  /**\n   * Get the onScroll handlers for this container.\n   * If one isn't found, create a new one.\n   */\n\n  if (!containerHandlers) {\n    containerHandlers = new Set();\n    onScrollHandlers.set(container, containerHandlers);\n  }\n  /**\n   * Create a new onScroll handler for the provided callback.\n   */\n\n\n  const info = createScrollInfo();\n  const containerHandler = createOnScrollHandler(container, onScroll, info, options);\n  containerHandlers.add(containerHandler);\n  /**\n   * Check if there's a scroll event listener for this container.\n   * If not, create one.\n   */\n\n  if (!scrollListeners.has(container)) {\n    const listener = () => {\n      const time = performance.now();\n\n      for (const handler of containerHandlers) handler.measure();\n\n      for (const handler of containerHandlers) handler.update(time);\n\n      for (const handler of containerHandlers) handler.notify();\n    };\n\n    scrollListeners.set(container, listener);\n    const target = getEventTarget(container);\n    window.addEventListener(\"resize\", listener, {\n      passive: true\n    });\n\n    if (container !== document.documentElement) {\n      resizeListeners.set(container, resize(container, listener));\n    }\n\n    target.addEventListener(\"scroll\", listener, {\n      passive: true\n    });\n  }\n\n  const listener = scrollListeners.get(container);\n  const onLoadProcesss = requestAnimationFrame(listener);\n  return () => {\n    var _a;\n\n    cancelAnimationFrame(onLoadProcesss);\n    /**\n     * Check if we even have any handlers for this container.\n     */\n\n    const currentHandlers = onScrollHandlers.get(container);\n    if (!currentHandlers) return;\n    currentHandlers.delete(containerHandler);\n    if (currentHandlers.size) return;\n    /**\n     * If no more handlers, remove the scroll listener too.\n     */\n\n    const scrollListener = scrollListeners.get(container);\n    scrollListeners.delete(container);\n\n    if (scrollListener) {\n      getEventTarget(container).removeEventListener(\"scroll\", scrollListener);\n      (_a = resizeListeners.get(container)) === null || _a === void 0 ? void 0 : _a();\n      window.removeEventListener(\"resize\", scrollListener);\n    }\n  };\n}\n\nexport { scroll };","map":{"version":3,"sources":["/Users/gagan/Desktop/sanjeev/someapp/node_modules/framer-motion/dist/es/render/dom/scroll/index.mjs"],"names":["resize","createScrollInfo","createOnScrollHandler","scrollListeners","WeakMap","resizeListeners","onScrollHandlers","getEventTarget","element","document","documentElement","window","scroll","onScroll","container","options","containerHandlers","get","Set","set","info","containerHandler","add","has","listener","time","performance","now","handler","measure","update","notify","target","addEventListener","passive","onLoadProcesss","requestAnimationFrame","_a","cancelAnimationFrame","currentHandlers","delete","size","scrollListener","removeEventListener"],"mappings":"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","sourcesContent":["import { resize } from '../resize/index.mjs';\nimport { createScrollInfo } from './info.mjs';\nimport { createOnScrollHandler } from './on-scroll-handler.mjs';\n\nconst scrollListeners = new WeakMap();\nconst resizeListeners = new WeakMap();\nconst onScrollHandlers = new WeakMap();\nconst getEventTarget = (element) => element === document.documentElement ? window : element;\nfunction scroll(onScroll, { container = document.documentElement, ...options } = {}) {\n    let containerHandlers = onScrollHandlers.get(container);\n    /**\n     * Get the onScroll handlers for this container.\n     * If one isn't found, create a new one.\n     */\n    if (!containerHandlers) {\n        containerHandlers = new Set();\n        onScrollHandlers.set(container, containerHandlers);\n    }\n    /**\n     * Create a new onScroll handler for the provided callback.\n     */\n    const info = createScrollInfo();\n    const containerHandler = createOnScrollHandler(container, onScroll, info, options);\n    containerHandlers.add(containerHandler);\n    /**\n     * Check if there's a scroll event listener for this container.\n     * If not, create one.\n     */\n    if (!scrollListeners.has(container)) {\n        const listener = () => {\n            const time = performance.now();\n            for (const handler of containerHandlers)\n                handler.measure();\n            for (const handler of containerHandlers)\n                handler.update(time);\n            for (const handler of containerHandlers)\n                handler.notify();\n        };\n        scrollListeners.set(container, listener);\n        const target = getEventTarget(container);\n        window.addEventListener(\"resize\", listener, { passive: true });\n        if (container !== document.documentElement) {\n            resizeListeners.set(container, resize(container, listener));\n        }\n        target.addEventListener(\"scroll\", listener, { passive: true });\n    }\n    const listener = scrollListeners.get(container);\n    const onLoadProcesss = requestAnimationFrame(listener);\n    return () => {\n        var _a;\n        cancelAnimationFrame(onLoadProcesss);\n        /**\n         * Check if we even have any handlers for this container.\n         */\n        const currentHandlers = onScrollHandlers.get(container);\n        if (!currentHandlers)\n            return;\n        currentHandlers.delete(containerHandler);\n        if (currentHandlers.size)\n            return;\n        /**\n         * If no more handlers, remove the scroll listener too.\n         */\n        const scrollListener = scrollListeners.get(container);\n        scrollListeners.delete(container);\n        if (scrollListener) {\n            getEventTarget(container).removeEventListener(\"scroll\", scrollListener);\n            (_a = resizeListeners.get(container)) === null || _a === void 0 ? void 0 : _a();\n            window.removeEventListener(\"resize\", scrollListener);\n        }\n    };\n}\n\nexport { scroll };\n"]},"metadata":{},"sourceType":"module"}